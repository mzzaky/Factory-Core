<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax System - FactoryCore Wiki</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">

    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: #0a0c10;
            color: #e4e6ea;
            min-height: 100vh;
        }

        /* ‚îÄ‚îÄ Page Header ‚îÄ‚îÄ */
        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
        }

        .page-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #10b981;
        }

        .page-header p {
            color: #9ca3af;
            font-size: 1.15rem;
            margin-top: 10px;
        }

        /* ‚îÄ‚îÄ Breadcrumb ‚îÄ‚îÄ */
        .breadcrumb {
            max-width: 1200px;
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }

        .breadcrumb a {
            color: #6b7280;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover {
            color: #10b981;
        }

        .breadcrumb-sep {
            color: #4b5563;
        }

        .breadcrumb-current {
            color: #34d399;
            font-weight: 600;
        }

        /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
        .content-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 30px;
            align-items: start;
        }

        /* ‚îÄ‚îÄ Side Nav ‚îÄ‚îÄ */
        .side-nav {
            position: sticky;
            top: 20px;
            background: rgba(13, 17, 23, 0.95);
            border: 1px solid rgba(52, 211, 153, 0.15);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .nav-header {
            padding: 20px;
            border-bottom: 1px solid rgba(52, 211, 153, 0.1);
            font-weight: 700;
            color: #e4e6ea;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
        }

        .nav-list {
            list-style: none;
            padding: 15px;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .nav-list a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            border-radius: 8px;
            color: #9ca3af;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-list a:hover {
            background: rgba(52, 211, 153, 0.05);
            color: #d1fae5;
        }

        .nav-list a.active {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(4, 120, 87, 0.05) 100%);
            color: #34d399;
            border: 1px solid rgba(52, 211, 153, 0.2);
            font-weight: 600;
        }

        /* ‚îÄ‚îÄ Main Content ‚îÄ‚îÄ */
        .main-content {
            background: #0d1117;
            border: 1px solid rgba(52, 211, 153, 0.15);
            border-radius: 16px;
            overflow: hidden;
        }

        .content-section {
            padding: 40px;
            border-bottom: 1px solid rgba(52, 211, 153, 0.08);
            scroll-margin-top: 20px;
        }

        .content-section:last-child {
            border-bottom: none;
        }

        .section-title {
            margin-bottom: 25px;
        }

        .section-title h2 {
            color: #10b981;
            font-size: 1.8rem;
            font-weight: 600;
            margin: 0 0 8px 0;
        }

        /* ‚îÄ‚îÄ Typography ‚îÄ‚îÄ */
        h3 {
            color: #34d399;
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        p {
            color: #d1d5db;
            line-height: 1.7;
            margin-bottom: 16px;
        }

        ul,
        ol {
            color: #d1d5db;
            margin-bottom: 20px;
            padding-left: 20px;
        }

        li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        strong {
            color: #34d399;
            font-weight: 600;
        }

        code {
            font-family: 'Fira Code', monospace;
            background: rgba(52, 211, 153, 0.1);
            padding: 3px 6px;
            border-radius: 5px;
            color: #34d399;
            font-size: 13px;
        }

        /* ‚îÄ‚îÄ Info / Warning Boxes ‚îÄ‚îÄ */
        .info-box {
            background: rgba(16, 185, 129, 0.05);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-left: 4px solid #10b981;
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
        }

        .info-box-title {
            color: #10b981;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1.05rem;
        }

        .warn-box {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.08) 0%, rgba(217, 119, 6, 0.03) 100%);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-left: 4px solid #fbbf24;
            border-radius: 12px;
            padding: 20px;
            margin: 24px 0;
            box-shadow: 0 8px 24px rgba(245, 158, 11, 0.05), inset 0 0 12px rgba(245, 158, 11, 0.02);
            position: relative;
            overflow: hidden;
        }

        .warn-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(245, 158, 11, 0.1), transparent 50%);
            pointer-events: none;
        }

        .warn-box .info-box-title {
            color: #fbbf24;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            text-shadow: 0 0 10px rgba(245, 158, 11, 0.2);
            position: relative;
            z-index: 1;
        }

        .warn-box div:last-child {
            color: #e5e7eb;
            position: relative;
            z-index: 1;
        }

        /* ‚îÄ‚îÄ Feature Cards Grid ‚îÄ‚îÄ */
        .phases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .phase-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(52, 211, 153, 0.1);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.2s ease, border-color 0.2s ease;
        }

        .phase-card:hover {
            border-color: rgba(52, 211, 153, 0.3);
            transform: translateY(-2px);
        }

        .phase-card .card-icon {
            font-size: 1.8rem;
            margin-bottom: 12px;
            display: block;
        }

        .phase-card h4 {
            color: #10b981;
            margin: 0 0 10px 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .phase-card p {
            color: #9ca3af;
            font-size: 14px;
            margin: 0;
        }

        /* ‚îÄ‚îÄ Table ‚îÄ‚îÄ */
        .table-wrapper {
            margin: 25px 0;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(52, 211, 153, 0.15);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table thead {
            background: rgba(16, 185, 129, 0.1);
        }

        .data-table th {
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            color: #34d399;
            text-transform: uppercase;
        }

        .data-table td {
            padding: 12px 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            color: #c9cdd4;
            font-size: 14px;
        }

        .data-table td:first-child {
            font-weight: 600;
            color: #e4e6ea;
        }

        /* ‚îÄ‚îÄ Code Block ‚îÄ‚îÄ */
        .code-wrap {
            position: relative;
            margin: 20px 0;
        }

        .code-block {
            background: #090d13;
            border: 1px solid rgba(52, 211, 153, 0.18);
            border-radius: 10px;
            padding: 22px 24px;
            overflow-x: auto;
            font-family: 'Fira Code', monospace;
            font-size: 13px;
            line-height: 1.75;
            color: #abb2bf;
        }

        .code-block .cm {
            color: #5c6370;
            font-style: italic;
        }

        /* comment */
        .code-block .ck {
            color: #e06c75;
        }

        /* key */
        .code-block .cv {
            color: #98c379;
        }

        /* string value */
        .code-block .cn {
            color: #d19a66;
        }

        /* number value */
        .code-block .cs {
            color: #56b6c2;
        }

        /* section heading */
        .code-block .ci {
            color: #61afef;
        }

        /* inline tag */

        .code-lang-badge {
            position: absolute;
            top: 10px;
            right: 48px;
            background: rgba(52, 211, 153, 0.1);
            border: 1px solid rgba(52, 211, 153, 0.2);
            color: #34d399;
            font-family: 'Fira Code', monospace;
            font-size: 11px;
            padding: 2px 10px;
            border-radius: 20px;
            letter-spacing: 0.5px;
            pointer-events: none;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(52, 211, 153, 0.08);
            border: 1px solid rgba(52, 211, 153, 0.2);
            color: #34d399;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            background: rgba(52, 211, 153, 0.18);
        }

        .copy-btn.copied {
            color: #10b981;
            border-color: #10b981;
        }

        /* ‚îÄ‚îÄ Dev Tip Box ‚îÄ‚îÄ */
        .dev-tip {
            background: linear-gradient(135deg, rgba(97, 175, 239, 0.07) 0%, rgba(56, 139, 253, 0.03) 100%);
            border: 1px solid rgba(97, 175, 239, 0.25);
            border-left: 4px solid #61afef;
            border-radius: 10px;
            padding: 18px 20px;
            margin: 20px 0;
        }

        .dev-tip .info-box-title {
            color: #61afef;
        }

        /* ‚îÄ‚îÄ Badge ‚îÄ‚îÄ */
        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            font-family: 'Fira Code', monospace;
        }

        .badge-pct {
            background: rgba(16, 185, 129, 0.12);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.25);
        }

        .badge-flat {
            background: rgba(245, 158, 11, 0.12);
            color: #fbbf24;
            border: 1px solid rgba(245, 158, 11, 0.25);
        }

        /* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
        @media (max-width: 900px) {
            .content-container {
                grid-template-columns: 1fr;
            }

            .side-nav {
                position: static;
                margin-bottom: 20px;
            }
        }

        @media (max-width: 768px) {
            .page-header h1 {
                font-size: 2.2rem;
            }

            .content-section {
                padding: 24px;
            }
        }
    </style>
</head>

<body>
    <div class="page-header">
        <h1>Tax System</h1>
        <p>Manage Your Factory Taxes &amp; Keep Your Empire Running</p>
    </div>

    <div class="breadcrumb">
        <a href="wiki_index.html">Wiki Home</a>
        <span class="breadcrumb-sep">&raquo;</span>
        <a href="#">Systems</a>
        <span class="breadcrumb-sep">&raquo;</span>
        <span class="breadcrumb-current">Tax System</span>
    </div>

    <div class="content-container">
        <nav class="side-nav">
            <div class="nav-header">On This Page</div>
            <ul class="nav-list">
                <li><a href="#overview" class="active">Overview</a></li>
                <li><a href="#calculation">Tax Calculation</a></li>
                <li><a href="#assessment">Assessment &amp; Due Dates</a></li>
                <li><a href="#commands">Commands &amp; GUI</a></li>
                <li><a href="#config-reference">Config Reference</a></li>
                <li><a href="#developer-api">Developer API</a></li>
            </ul>
        </nav>

        <main class="main-content">

            <!-- ‚ïê‚ïê‚ïê‚ïê OVERVIEW ‚ïê‚ïê‚ïê‚ïê -->
            <section class="content-section" id="overview">
                <div class="section-title">
                    <h2>Overview</h2>
                </div>
                <p>
                    The <strong>Tax System</strong> in FactoryCore adds a meaningful economic challenge by requiring
                    factory owners to pay periodic taxes based on the value and level of their factories. Ignoring
                    your taxes is not an option ‚Äî unpaid bills accumulate late fees and are prominently flagged in
                    the Tax Center GUI.
                </p>
                <div class="info-box">
                    <div class="info-box-title">üí° Core Concept</div>
                    <div>Taxes are assessed <em>per factory</em>, not per player. Every factory you own generates an
                        independent tax bill calculated from its base price, current level, and your active research
                        buffs. Staying on top of these payments is essential for long-term profitability.
                    </div>
                </div>

                <div class="phases-grid">
                    <div class="phase-card">
                        <span class="card-icon">üßÆ</span>
                        <h4>Dynamic Calculation</h4>
                        <p>Tax rates scale with factory level using a configurable level multiplier, meaning high-tier
                            factories generate significantly larger bills.</p>
                    </div>
                    <div class="phase-card">
                        <span class="card-icon">üî¨</span>
                        <h4>Research Deductions</h4>
                        <p>Players who invest in the <strong>Fiscal Optimization</strong> research path receive a
                            percentage reduction on their final tax amount each cycle.</p>
                    </div>
                    <div class="phase-card">
                        <span class="card-icon">‚ö†Ô∏è</span>
                        <h4>Late Fees</h4>
                        <p>Overdue taxes are flagged in the GUI and automatically incur a one-time penalty charge,
                            making prompt payment the most economical choice.</p>
                    </div>
                    <div class="phase-card">
                        <span class="card-icon">üíª</span>
                        <h4>Tax Center GUI</h4>
                        <p>A comprehensive graphical interface lets you view all outstanding bills, preview upcoming
                            taxes, and settle everything with a single click.</p>
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê TAX CALCULATION ‚ïê‚ïê‚ïê‚ïê -->
            <section class="content-section" id="calculation">
                <div class="section-title">
                    <h2>Tax Calculation</h2>
                </div>
                <p>The amount owed per factory is determined dynamically during each assessment cycle based on
                    three factors: the factory's <strong>base price</strong>, its <strong>current level</strong>,
                    and any active <strong>research buffs</strong> the owner has unlocked.</p>

                <h3>The Tax Formula</h3>
                <div class="code-wrap">
                    <span class="code-lang-badge">Formula</span>
                    <pre class="code-block"><span class="cs">Total Tax Rate</span>  = Base Rate + ((Factory Level - 1) √ó Level Multiplier)
<span class="cs">Base Tax Amount</span> = Factory Price √ó Total Tax Rate
<span class="cs">Final Tax Amount</span> = Base Tax Amount - Fiscal Optimization Research Reduction</pre>
                </div>

                <h3>Example Scenarios</h3>
                <p>Assuming <code>rate</code> = <strong>5.0%</strong> and <code>level-multiplier</code> =
                    <strong>2.5%</strong>:</p>

                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Factory Level</th>
                                <th>Effective Tax Rate</th>
                                <th>Tax on a $10,000 Factory</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Level 1</td>
                                <td><span class="badge badge-pct">5.0%</span></td>
                                <td><strong>$500</strong></td>
                            </tr>
                            <tr>
                                <td>Level 2</td>
                                <td><span class="badge badge-pct">7.5%</span></td>
                                <td><strong>$750</strong></td>
                            </tr>
                            <tr>
                                <td>Level 3</td>
                                <td><span class="badge badge-pct">10.0%</span></td>
                                <td><strong>$1,000</strong></td>
                            </tr>
                            <tr>
                                <td>Level 4</td>
                                <td><span class="badge badge-pct">12.5%</span></td>
                                <td><strong>$1,250</strong></td>
                            </tr>
                            <tr>
                                <td>Level 5</td>
                                <td><span class="badge badge-pct">15.0%</span></td>
                                <td><strong>$1,500</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="warn-box">
                    <div class="info-box-title">‚ö†Ô∏è Upgrading Increases Your Tax Burden</div>
                    <div>
                        Each level added to a factory increases its effective tax rate by <strong>+2.5%</strong>.
                        Before upgrading a factory, factor in the ongoing tax liability ‚Äî the extra throughput
                        benefits must outweigh the increased recurring costs. See the
                        <strong>Upgrade System</strong> wiki page for full level benefit details.
                    </div>
                </div>

                <h3>üî¨ Fiscal Optimization Research</h3>
                <p>
                    Players who invest in the <strong>Fiscal Optimization</strong> research path earn a permanent
                    percentage deduction on their calculated tax bill. For example, a player with a
                    <strong>10% tax reduction buff</strong> would reduce a $1,000 tax bill down to
                    <strong>$900</strong>.
                    This research benefit is applied after the base calculation and stacks well with owning multiple
                    high-level factories.
                </p>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê ASSESSMENT & DUE DATES ‚ïê‚ïê‚ïê‚ïê -->
            <section class="content-section" id="assessment">
                <div class="section-title">
                    <h2>Assessment &amp; Due Dates</h2>
                </div>
                <p>Taxes are not charged in real-time ‚Äî they are assessed and billed in periodic cycles managed
                    automatically by the server.</p>

                <h3>1. Assessment Cycle</h3>
                <p>
                    Taxes are automatically assessed and added to a factory's balance on a configurable interval
                    defined by <code>tax.interval-ticks</code> in <code>config.yml</code>. The default value is
                    <code>144,000 ticks</code>, equivalent to approximately 3 in-game days (or ~2 real-life hours
                    at standard server TPS). When an assessment fires, each factory owner receives a chat
                    notification (if <code>notify-on-assessment: true</code>).
                </p>

                <h3>2. Grace Period &amp; Due Date</h3>
                <p>
                    After each assessment, players are given a grace period to pay their bill. This period is
                    controlled by the <code>tax.due-days</code> setting (default <strong>7 real-time days</strong>).
                    The Tax Center GUI displays the exact due date for each factory's outstanding bill.
                </p>

                <h3>3. Overdue &amp; Late Fees</h3>
                <p>
                    If a tax is not paid before the due date, it is automatically marked as <strong>Overdue</strong>.
                    The following consequences apply immediately:
                </p>
                <ul>
                    <li>A one-time <strong>late fee penalty</strong> is added, calculated from the
                        <code>tax.late-fee-rate</code> setting (default <strong>5.0%</strong> of the original
                        bill).
                    </li>
                    <li>The factory's entry in the Tax Center GUI is highlighted in <strong>red</strong> to draw
                        immediate attention.</li>
                    <li>Continuous overdue warnings are dispatched to the player (if
                        <code>notify-on-overdue: true</code>).
                    </li>
                </ul>

                <div class="info-box">
                    <div class="info-box-title">üìã Offline Tax Accumulation</div>
                    <div>
                        Taxes are assessed against <em>factories</em>, not players. This means your tax bills will
                        continue to grow even while you are offline, as long as the server is running. Plan ahead
                        and maintain a sufficient balance to avoid returning to a pile of overdue notices.
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê COMMANDS & GUI ‚ïê‚ïê‚ïê‚ïê -->
            <section class="content-section" id="commands">
                <div class="section-title">
                    <h2>Commands &amp; GUI</h2>
                </div>

                <h3>Player Commands</h3>
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Command</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>/fc tax</code></td>
                                <td>Opens the <strong>Tax Center GUI</strong>. Also accepts <code>/fc taxes</code>
                                    as an alias.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Tax Center GUI Features</h3>
                <p>The Tax Center is a comprehensive interface for managing all of your factory tax obligations
                    in one place. It includes the following panels:</p>
                <ul>
                    <li><strong>Tax Overview</strong> ‚Äî A summarized look at total tax due across all your factories,
                        factory count, and the time remaining until the next assessment cycle.</li>
                    <li><strong>Factory Breakdown</strong> ‚Äî Individual entries for each factory, showing the specific
                        tax amount owed, the due date, and a direct click-to-pay button.</li>
                    <li><strong>Tax Calculator</strong> ‚Äî A preview of your upcoming tax burden based on current
                        factory levels and active research buffs ‚Äî useful for financial planning.</li>
                    <li><strong>Payment History</strong> ‚Äî A scrollable log of your recent tax payment transactions.
                    </li>
                    <li><strong>Pay All</strong> ‚Äî A convenience button to settle all outstanding taxes across every
                        factory in a single action, provided you have a sufficient balance.</li>
                </ul>

                <div class="warn-box">
                    <div class="info-box-title">‚ö†Ô∏è Overdue Factories are Highlighted</div>
                    <div>
                        Factories with an overdue tax bill are displayed in <strong>red</strong> inside the
                        Factory Breakdown panel. The late fee is applied only once, but the outstanding amount
                        will keep accumulating with each new assessment cycle until paid.
                    </div>
                </div>

                <h3>Admin Commands</h3>
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Command</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>/fc admin tax assess</code></td>
                                <td>Forces an immediate tax assessment for all factories on the server, bypassing
                                    the normal cycle timer.</td>
                            </tr>
                            <tr>
                                <td><code>/fc admin tax check</code></td>
                                <td>Forces a server-wide overdue check, applying late fees to any factories that
                                    have crossed their due date.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê CONFIG REFERENCE ‚ïê‚ïê‚ïê‚ïê -->
            <section class="content-section" id="config-reference">
                <div class="section-title">
                    <h2>Config Reference</h2>
                </div>
                <p>
                    All tax-related settings are managed within the <code>tax:</code> section of
                    <code>config.yml</code>. Notification sounds and logging flags relevant to the tax system
                    are found in the <code>notifications:</code> and <code>logging:</code> sections respectively.
                </p>

                <div class="code-wrap">
                    <span class="code-lang-badge">YAML</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre
                        class="code-block"><span class="cs">tax:</span>
  <span class="ck">enabled:</span> <span class="cv">true</span>
  <span class="ck">rate:</span> <span class="cn">5.0</span>              <span class="cm"># Base tax rate (%) applied to Level 1 factories</span>
  <span class="ck">interval-ticks:</span> <span class="cn">144000</span>    <span class="cm"># Ticks between assessments (20 ticks = 1 second)</span>
  <span class="ck">level-multiplier:</span> <span class="cn">2.5</span>       <span class="cm"># Additional tax (%) added per factory level</span>
  <span class="ck">due-days:</span> <span class="cn">7</span>              <span class="cm"># Real-time days players have to pay before overdue</span>
  <span class="ck">late-fee-rate:</span> <span class="cn">5.0</span>        <span class="cm"># One-time penalty (%) when a tax becomes overdue</span>
  <span class="ck">notify-on-assessment:</span> <span class="cv">true</span>  <span class="cm"># Chat notification when tax is assigned</span>
  <span class="ck">notify-on-overdue:</span> <span class="cv">true</span>     <span class="cm"># Chat notification when a tax misses its due date</span>

<span class="cs">notifications:</span>
  <span class="cs">sound:</span>
    <span class="ck">tax-due:</span> <span class="cv">BLOCK_NOTE_BLOCK_BASS</span>  <span class="cm"># Sound played when a tax becomes overdue</span>

<span class="cs">logging:</span>
  <span class="ck">log-taxes:</span> <span class="cv">true</span>  <span class="cm"># Output tax-related events to the server log file</span></pre>
                </div>

                <h3>Key Configuration Options</h3>
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>Default</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>rate</code></td>
                                <td><span class="badge badge-pct">5.0%</span></td>
                                <td>Base tax percentage applied to all Level 1 factories.</td>
                            </tr>
                            <tr>
                                <td><code>level-multiplier</code></td>
                                <td><span class="badge badge-pct">+2.5%</span></td>
                                <td>Additional tax rate added per factory level beyond Level 1.</td>
                            </tr>
                            <tr>
                                <td><code>interval-ticks</code></td>
                                <td><span class="badge badge-flat">144,000</span></td>
                                <td>Ticks between each automatic tax assessment (144,000 = ~2 hours real-time).</td>
                            </tr>
                            <tr>
                                <td><code>due-days</code></td>
                                <td><span class="badge badge-flat">7 days</span></td>
                                <td>Real-time days a player has to pay before a tax is marked overdue.</td>
                            </tr>
                            <tr>
                                <td><code>late-fee-rate</code></td>
                                <td><span class="badge badge-pct">5.0%</span></td>
                                <td>One-time late fee percentage added to the original bill when overdue.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="dev-tip">
                    <div class="info-box-title">üîß Balancing the Tax Economy</div>
                    <div>
                        Setting <code>interval-ticks</code> too low can make the economy feel punishing, while
                        setting it too high reduces the tax system's strategic impact. A good starting point is
                        to align the assessment interval with your server's salary interval ‚Äî the default
                        <code>salary.interval-ticks</code> of <code>24,000</code> (1 in-game day) means taxes
                        are billed roughly every 6 salary cycles.
                    </div>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê DEVELOPER API ‚ïê‚ïê‚ïê‚ïê -->
            <section class="content-section" id="developer-api">
                <div class="section-title">
                    <h2>Developer API</h2>
                </div>
                <p>
                    If you are building add-ons or extending FactoryCore, the Tax System is managed by the
                    <code>TaxManager</code> class. The key patterns below will help you integrate cleanly.
                </p>

                <h3>Accessing TaxManager</h3>
                <div class="code-wrap">
                    <span class="code-lang-badge">Java</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre class="code-block">TaxManager taxManager = plugin.getTaxManager();</pre>
                </div>

                <h3>Useful API Methods</h3>
                <div class="code-wrap">
                    <span class="code-lang-badge">Java</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre class="code-block"><span class="cm">// Calculate what a factory's next tax WOULD be (includes research buffs)</span>
double predictedTax = taxManager.calculateTax(factory);

<span class="cm">// Get the total unpaid tax amount for a specific player</span>
double totalDue = taxManager.getTotalTaxDue(player.getUniqueId());

<span class="cm">// Allow a player to forcefully pay a specific factory's tax</span>
boolean success = taxManager.payTax(player, factoryId);

<span class="cm">// Fetch a specific factory's current tax record (null if none)</span>
TaxManager.TaxRecord record = taxManager.getTaxRecord(factoryId);

<span class="cm">// Check if a factory is overdue</span>
boolean isOverdue = record != null &amp;&amp; record.overdue;</pre>
                </div>

                <h3>Developer Tips &amp; Best Practices</h3>
                <div class="dev-tip">
                    <div class="info-box-title">üí° Never Cache TaxRecord Objects</div>
                    <div>
                        Tax records are highly mutable. Always fetch the latest version directly from
                        <code>TaxManager</code> using <code>getTaxRecord(String factoryId)</code> before
                        reading <code>amountDue</code> or <code>overdue</code> states ‚Äî a cached object
                        may reflect stale data from a previous assessment cycle.
                    </div>
                </div>
                <div class="dev-tip">
                    <div class="info-box-title">üí° Economy Checks Are Handled Automatically</div>
                    <div>
                        When calling <code>.payTax()</code>, <code>TaxManager</code> automatically verifies the
                        player's balance via Vault. You do not need to pre-check with
                        <code>plugin.getEconomy().has()</code>; the method will safely return <code>false</code>
                        if funds are insufficient.
                    </div>
                </div>
                <div class="dev-tip">
                    <div class="info-box-title">üí° PersistentDataContainer Integration</div>
                    <div>
                        <code>TaxCenterGUI</code> stores <code>tax_factory_id</code> inside each item's
                        <code>ItemMeta</code> via PDC. If you need to intercept tax-item click events in your
                        own Listener, access the PDC key <code>"tax_factory_id"</code> using the plugin's
                        namespace key.
                    </div>
                </div>

                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Tip</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data Storage</td>
                                <td>Tax data lives in <code>data/taxes.yml</code>, separate from factory data files.
                                    This allows the tax ledger to be backed up or wiped independently without
                                    affecting player property.</td>
                            </tr>
                            <tr>
                                <td>Offline Assessments</td>
                                <td>Taxes accrue on factories, not players. To implement activity-based immunity,
                                    intercept or extend the <code>assessTaxes()</code> method.</td>
                            </tr>
                            <tr>
                                <td>GUI Customization</td>
                                <td>Listen for player click events and read the <code>tax_factory_id</code> PDC
                                    key from the clicked item to identify which factory the action relates to.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

        </main>
    </div>

    <script>
        // Copy-to-clipboard for code blocks
        function copyCode(btn) {
            const pre = btn.closest('.code-wrap').querySelector('pre');
            navigator.clipboard.writeText(pre.innerText).then(() => {
                btn.textContent = 'Copied!';
                btn.classList.add('copied');
                setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
            });
        }

        const sections = document.querySelectorAll('.content-section');
        const navLinks = document.querySelectorAll('.nav-list a');

        navLinks.forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.3
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.getAttribute('id');
                    navLinks.forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === '#' + id) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        }, observerOptions);

        sections.forEach(section => {
            observer.observe(section);
        });
    </script>
</body>

</html>